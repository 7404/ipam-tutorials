<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Author" content="Clement Farabet">
  <meta name="Copyright" content="Clement Farabet">
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1138.47">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 18.0px Helvetica; color: #606060}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 16.0px Helvetica}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #ffffff; background-color: #444444}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica; min-height: 17.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 11.0px Menlo; color: #ffffff; background-color: #444444; min-height: 13.0px}
    li.li3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    span.s1 {font: 12.0px Menlo; background-color: #ffffff}
    span.s2 {font: 12.0px Menlo}
    ul.ul1 {list-style-type: hyphen}
  </style>
</head>
<body>
<p class="p1"><b>1. Basic stuff</b></p>
<p class="p2"><br></p>
<p class="p3">You should now have <a href="http://www.torch.ch/">Torch7</a> properly installed.</p>
<p class="p2"><br></p>
<p class="p3">This first (very simple) tutorial will just walk you through the shell, and show you how to test and learn new stuff quickly.</p>
<p class="p2"><br></p>
<p class="p4"><b>1. Running Torch</b></p>
<p class="p2"><br></p>
<p class="p3">Fire up a terminal, and verify that <span class="s1">torch</span> is in your path:</p>
<p class="p2"><br></p>
<p class="p5">$ which torch</p>
<p class="p5">/usr/local/bin/torch</p>
<p class="p2"><br></p>
<p class="p3">Then run torch:</p>
<p class="p2"><br></p>
<p class="p5">$ torch</p>
<p class="p5">Try the IDE: torch -ide</p>
<p class="p5">Type help() for more info</p>
<p class="p5">Torch 7.0<span class="Apple-converted-space">  </span>Copyright (C) 2001-2011 Idiap, NEC Labs, NYU</p>
<p class="p5">Lua 5.1<span class="Apple-converted-space">  </span>Copyright (C) 1994-2008 Lua.org, PUC-Rio</p>
<p class="p5">t7&gt;<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p3"><span class="s2">t7&gt;</span> is the prompt, from which you can type torch commands.</p>
<p class="p2"><br></p>
<p class="p3">That’s it, you’ve got Torch running. You can now type commands in.</p>
<p class="p2"><br></p>
<p class="p4"><b>2. Basic Lua</b></p>
<p class="p2"><br></p>
<p class="p3">Torch is entirely built around <a href="http://www.lua.org/">Lua</a>, so the first thing you have to know is get some basic knowledge about the <a href="http://www.lua.org/docs.html">language</a>. The <a href="http://www.lua.org/manual/5.1/">online book</a> is great for that.<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p3">Here I’ll just summarize a couple of very basic things to get you started.</p>
<p class="p2"><br></p>
<p class="p6"><b>a. Variables</b></p>
<p class="p2"><br></p>
<p class="p3">Creating variables is straightforward, Lua is dynamically typed language. Printing variables from the prompt is a bit misleading, you have to add the ‘=‘ sign before it:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; a = 10</p>
<p class="p5">t7&gt; print(a)</p>
<p class="p5">10</p>
<p class="p5">t7&gt; = a</p>
<p class="p5">10</p>
<p class="p5">t7&gt; b = a + 1</p>
<p class="p5">t7&gt; = b</p>
<p class="p5">11</p>
<p class="p7"><b></b><br></p>
<p class="p6"><b>b. Lua’s universal data structure: the table</b></p>
<p class="p2"><br></p>
<p class="p3">The best thing about Lua is its consistency, and compactness. The whole language relies on a single data structure, the table, which will allow you to construct the most complex programs, with style!</p>
<p class="p2"><br></p>
<p class="p3">The Lua table can be used as:</p>
<ul class="ul1">
  <li class="li3">an array (with linearly stored values, of arbitrary types)</li>
  <li class="li3">a hash-table (with hashed key/value pairs)</li>
  <li class="li3">an object (which is just a hash-table)</li>
  <li class="li3">a namespace (any package in Lua is a simple table, in fact the global namespace, _G, is also a table)</li>
</ul>
<p class="p2"><br></p>
<p class="p3">You already know enough about tables, let’s hack around:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; t = {}</p>
<p class="p5">t7&gt; =t</p>
<p class="p5">{}</p>
<p class="p5">t7&gt; t = {1,2,3,4}</p>
<p class="p5">t7&gt; =t</p>
<p class="p5">{[1] = 1</p>
<p class="p5"><span class="Apple-converted-space"> </span>[2] = 2</p>
<p class="p5"><span class="Apple-converted-space"> </span>[3] = 3</p>
<p class="p5"><span class="Apple-converted-space"> </span>[4] = 4}</p>
<p class="p5">t7&gt; = {1,2,3,'mixed types',true}</p>
<p class="p5">{[1] = 1</p>
<p class="p5"><span class="Apple-converted-space"> </span>[2] = 2</p>
<p class="p5"><span class="Apple-converted-space"> </span>[3] = 3</p>
<p class="p5"><span class="Apple-converted-space"> </span>[4] = string : "mixed types"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[5] = true}</p>
<p class="p5">t7&gt; t =<span class="Apple-converted-space">  </span>{4,3,2,1}</p>
<p class="p2"><br></p>
<p class="p3">In the example above, we’ve shown how to use a table as a linear array. Lua is one-based, like Matlab, so if we try to get the length of this last array created, it’ll be equal to the number of elements we’ve put in:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; =#t</p>
<p class="p5">4</p>
<p class="p2"><br></p>
<p class="p3">Ok, let’s see about hash-tables now:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; h = {firstname='Paul', lastname='Eluard', age='117'}</p>
<p class="p5">t7&gt; =h</p>
<p class="p5">{[firstname] = string : "Paul"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[lastname]<span class="Apple-converted-space">  </span>= string : "Eluard"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[age] <span class="Apple-converted-space">      </span>= string : "117"}</p>
<p class="p2"><br></p>
<p class="p3">So now mixing arrays and hash-tables is easy:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; h = {firstname='Paul', lastname='Eluard', age='117', 1, 2, 3}</p>
<p class="p5">t7&gt; =h</p>
<p class="p5">{[1] <span class="Apple-converted-space">        </span>= 1</p>
<p class="p5"><span class="Apple-converted-space"> </span>[2] <span class="Apple-converted-space">        </span>= 2</p>
<p class="p5"><span class="Apple-converted-space"> </span>[3] <span class="Apple-converted-space">        </span>= 3</p>
<p class="p5"><span class="Apple-converted-space"> </span>[firstname] = string : "Paul"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[lastname]<span class="Apple-converted-space">  </span>= string : "Eluard"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[age] <span class="Apple-converted-space">      </span>= string : "117"}</p>
<p class="p5">t7&gt;<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p3">Easy right?</p>
<p class="p2"><br></p>
<p class="p3">So we’ve seen a couple of basic types already: strings, numbers, tables, booleans (true/false). There’s one last type in Lua: the function. Functions are first-order citizens in Lua, which means that they can be treated as regular variables. This is great, because it’s the reason why we can construct very powerful data structures (such as objects) with tables:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; h = {firstname='Paul', lastname='Eluard', age='117',</p>
<p class="p5">. &gt;<span class="Apple-converted-space">      </span>print=function(self)</p>
<p class="p5">. &gt; <span class="Apple-converted-space">              </span>print(self.firstname .. ' ' .. self.lastname<span class="Apple-converted-space"> </span></p>
<p class="p5">.&gt;<span class="Apple-converted-space">                      </span>.. ' (age: ' .. self.age .. ')')</p>
<p class="p5">. &gt;<span class="Apple-converted-space">      </span>end</p>
<p class="p5">. &gt; <span class="Apple-converted-space">    </span>}</p>
<p class="p8"><br></p>
<p class="p5">t7&gt; =h</p>
<p class="p5">{[firstname] = string : "Paul"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[print] <span class="Apple-converted-space">    </span>= function: 0x7f885d00c430</p>
<p class="p5"><span class="Apple-converted-space"> </span>[lastname]<span class="Apple-converted-space">  </span>= string : "Eluard"</p>
<p class="p5"><span class="Apple-converted-space"> </span>[age] <span class="Apple-converted-space">      </span>= string : "117"}</p>
<p class="p2"><br></p>
<p class="p3">In this example above, we’re basically storing a function at the key (hash) ‘print’. It’s fairly straightforward, note that the function takes one argument, named self, which is assumed to be the object itself. The function simply concatenates the fields of the table ‘self’, and prints the whole string.</p>
<p class="p2"><br></p>
<p class="p3">One important note: accessing fields of a table is either done using square brackets [], or the ‘.’ operator. The square brackets are more general: they allow the use of arbitrary strings. In the following, we now try to access the elements of ‘h’, that we just created:</p>
<p class="p2"><br></p>
<p class="p5">t7&gt; h. + TAB</p>
<p class="p5">h.age<span class="Apple-converted-space">        </span>h.firstname<span class="Apple-converted-space">  </span>h.lastname <span class="Apple-converted-space">  </span>h.print(<span class="Apple-converted-space">     </span></p>
<p class="p8"><br></p>
<p class="p5">t7&gt; = h.print</p>
<p class="p5">function: 0x7f885d00ec80</p>
<p class="p8"><br></p>
<p class="p5">t7&gt; h.print(h)</p>
<p class="p5">Paul Eluard (age: 117)</p>
<p class="p8"><br></p>
<p class="p5">t7&gt; h:print()</p>
<p class="p5">Paul Eluard (age: 117)</p>
<p class="p2"><br></p>
<p class="p3">On the first line we type h. and then use TAB to complete and automatically explore the symbols present in h. We then print h.print, and confirm that it is indeed a function.</p>
<p class="p2"><br></p>
<p class="p3">At the next line, we call the function h.print, and pass h as the argument (which becomes self in the body of the function). This is fairly natural, but a bit heavy to manipulate objects. Lua provides a simple shortcut, ‘:’, the column, which passes the parent table as the first argument: h:print() is strictly equivalent to h.print(h).</p>
<p class="p2"><br></p>
<p class="p6"><b>c. Functions</b></p>
<p class="p2"><br></p>
<p class="p3">A few more things about functions: functions in Lua are proper closures, so in combination with tables, you can use them to build complex and very flexible programs. An example of closure is given here:</p>
<p class="p2"><br></p>
<p class="p5">myfuncs = {}</p>
<p class="p5">for i = 1,4 do</p>
<p class="p5"><span class="Apple-converted-space">   </span>local calls = 10</p>
<p class="p5"><span class="Apple-converted-space">   </span>myfuncs[i] = function()</p>
<p class="p5"><span class="Apple-converted-space">      </span>calls = calls + 1</p>
<p class="p5"><span class="Apple-converted-space">      </span>print(‘this function has been called ’ .. i .. ‘times’)</p>
<p class="p5"><span class="Apple-converted-space">   </span>end</p>
<p class="p5">end</p>
<p class="p8"><br></p>
<p class="p5">t7&gt; myfuncs[1]()</p>
<p class="p5">1</p>
<p class="p5">t7&gt; myfuncs[1]()</p>
<p class="p5">2</p>
<p class="p5">t7&gt; myfuncs[4]()</p>
<p class="p5">1</p>
<p class="p5">t7&gt; myfuncs[4]()</p>
<p class="p5">2</p>
<p class="p5">t7&gt; myfuncs[1]()</p>
<p class="p5">3</p>
<p class="p2"><br></p>
<p class="p3">You can use such closures to create objects on the fly, that is, tables which combine functions and data to act upon. Thanks to closure, data can live in arbitrary locations (not necessarily the object’s table), and simply be bound at runtime to the function’s scope.</p>
<p class="p2"><br></p>
<p class="p4"><b>3. Saving code to files, running files</b></p>
<p class="p2"><br></p>
<p class="p3">Before we go any further, let’s just review one basic thing: saving code to files, and executing them.</p>
<p class="p2"><br></p>
<p class="p3">As Torch relies on Lua, it’s best to give all your files a .lua extension. In this directory, a basic program is provided: 1_helloworld.lua. Look at its content, and then execute it:</p>
<p class="p2"><br></p>
<p class="p5">$ cat 1_helloworld.lua</p>
<p class="p5">…</p>
<p class="p8"><br></p>
<p class="p5">$ torch 1_helloworld.lua</p>
<p class="p5">…</p>
<p class="p5">Hello World!</p>
<p class="p8"><br></p>
<p class="p5">$ torch</p>
<p class="p5">…</p>
<p class="p5">t7&gt; dofile ‘1_helloworld.lua’</p>
<p class="p5">Hello World!</p>
<p class="p2"><br></p>
<p class="p3">That’s it, you can either run programs form your shell, or from the Torch prompt. You can also run programs from the shell, and get an interactive prompt whenever an error occurs, or the program terminates (good for debugging):</p>
<p class="p2"><br></p>
<p class="p5">$ torch -i 1_helloworld.lua</p>
<p class="p5">…</p>
<p class="p5">Hello World!</p>
<p class="p5">t7&gt;</p>
<p class="p2"><br></p>
<p class="p3">We’re good with all the basic things: you now know how to run code, from files or from the prompt, and write basic Lua (which is almost all Lua is!).</p>
</body>
</html>
